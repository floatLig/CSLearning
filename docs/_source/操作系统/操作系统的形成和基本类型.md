### 操作系统的发展和基本类型

在计算机发展初期，硬件技术处于起步阶段，此时操作系统并未形成，软件概念还不明确。以后随着硬件技术的发展，促进了`软件概念的形成`，从而也`推动了操作系统的形成和发展`。反过来，软件的发展也促进了硬件的发展。

**1. 手工操作阶段：**

要运行什么程序都是需要人工装入计算机。这个过程需要很多的人工干预，有一个问题是手工操作慢而CPU处理快。造成资源浪费，而且用户操作不便。

**2. 早期批处理阶段【作业自动转化】：**

为解决人工干预的问题，就必须缩短`建立作业（即用户的一个计算任务）和人工操作的时间`。所以有一个好的办法是：从一个作业自动转到下一个作业【使用监督程序来完成，而这种监督程序就是操作系统的雏形】。

早期的批处理分为`联机批处理程序`和`脱机批处理程序`。

（1）早期联机批处理程序

首先说明：`脱机批处理程序是优于联机批处理程序的`。

“联机”的含义是：作业的输入输出（I/O），调入内存等`都是由CPU控制的`，而且这种批处理程序是单道批处理程序（在内存中只保留一道作业）。

这种单道批处理系统虽然能实现作业的自动转换工作．但由千联机操作，影响了CPU 速度的发挥，仍不能很好地利用系统资源。

（2）早期的脱机批处理程序

为了解决早期批处理程序的问题（CPU快而I/O慢），人们引入了卫星机。

卫星机不与主机直接连接，只与外部设备打交道。`卫星机专门负责输入输出工作，主机专门完成快速计算任务，从而两者可以并行操作`。由于`I/O不受主机的直接控制`，所以称为脱机批处理。

**3. 多道批处理程序：**

早期的单道批处理程序只有一道作业在内存，因此资源利用率仍不高。

多道程序设计的基本思想是：`在内存中同时存放多道程序，在管理程序的控制下交替地执行`。这样子，在一段给定的时间内，计算机所能完成的总工作量（称为系统的`吞吐量`）也增加了。

由一道程序执行到两道程序执行产生了“质”的飞跃，而由两道到更多程序的执行却仅仅是“量”的变化。

在多道批处理程序中还必须解决一系列的问题，包括：内存的分配和保护问题、处理机的调度和作业的合理搭配问题、I/O设备的共享和方便使用问题、文件的存放和读写操作及安全性问题等。处理这些问题正是操作系统应具备的基本功能。

在这种操作系统中，用户的计算任务按`“作业”（Job）`进行管理。所谓作业，是用户定义的、由计算机完成的工作单位，它通常是一组计算机程序、文件和对操作系统的控制语句。

多道批处理系统有两个特点： 一是多道，二是成批。“多道”是指内存中`存放多个作业`，并在外存上存放大扯的后备作业。。而“成批＂的特点是在系统运行过程中`不允许用户和机器之间发生交互作用`。

**4. 分时系统：**

多道批处理系统缺少人机交互能力，为了处理这个缺点，人们开发出了`分时系统`。例如Linux。

所谓分时，主要是对`CPU时间的共享`。人们为了提高资源的利用率，采取了并行操作的技术，如CPU和通道并行操作、通道与通道并行操作、通道与I/O并行操作。

分时的时间单位称为`时间片`，它往往是很短的，如几十毫秒。这种分时系统的实现，需要有中断机构和时钟系统的支持。

使用分时系统，CPU可在用户操作时，抽出时间去完成其他进程的服务。但是由于分时的时间很短（只有几十毫秒），从而让用户认为整个系统都是只为他自己而服务，而并未感受CPU处理了其他的内容。

实时系统为用户提供了友好的接口，即用户能方便地与系统进行人机对话，用户能在较短时间内得到响应。

**5. 实时系统：**

有些领域对`实时`（表示“及时”或“即使”）处理的需求，比如`卫星发射自动装置`、工业生产自动控制、订票系统，人们开发出了`实时系统`。实时系统具有`专用性`,与分时系统相比，实时系统要求`有更高的可靠性和更严格的及时性`。

实时系统有三种典型应用形式，分别为：`过程控制系统`（用于工业生产地自动控制）、`信息查询系统`（特点时配置有大型文件系统或数据库）和`事物处理系统`（用户和系统需要频繁地进行交互作用）。

**6. 操作系统的发展:**

除此之外，还有分布式操作系统、嵌入式操作系统、秒杀操作系统、多处理器操作系统、网络操作系统、个人机操作系统等。

### 操作系统的主要结构

一个大的操作系统，是按照什么方式集合在一起？一般来讲，操作系统主要有以下体系结构，即：单体结构、层次结构、虚拟机结构、微服务结构、客户-服务器结构。

**1. 单体结构：**

单体结构实际上是`没有结构`。

![模块调用示意图.jpg](../../_img/模块调用示意图.jpg)

操作系统上有大量的模块。所谓`模块就是完成一定功能的子系统，它是构成软件的基本单位。`单体结构的操作系统就如同我们通常编写的程序那样，各个模块之间直接调用，不分层次。

这样子有明显的缺点：`牵一发而动全身`，可靠性降低。

**2. 层次结构：**

层次操作系统的设计思想是：按照操作系统`各模块的功能和相互依存关系`，把系统中的模块分成若干层。

![分层.jpg](../../_img/分层.jpg)

实际使用的操作系统多数是采用层次结构，如`UNIX`。

一个操作系统应划分多少层、各层处于什么位置、相互间如何联系等并无固定的模式。一般的原则是：`接近用户应用的模块在上层，贴近硬件的驱动程序模块在下层`。

`处于下层的程序模块`也称为操作系统的`内核`，这一部分模块包括中断处理程序、各种常用设备的驱动程序，以及运行频率较高的模块（如时钟管理程序、进程调度、内存管理模块程序）等。为了提高操作系统的执行效率和便于实时特殊保护，`它们一般常驻内存`。

**3. 虚拟机结构：**

虚拟机结构的核心部分是虚拟机监控程序（Virtual Machine Monitor，VMM）。虚拟机`能够共享物理机资源来实现`。

现代虚拟机设计有两种类型。一种是底层为一个虚拟机管理程序(有些电脑需要在BIOS开启，比如联想)，其上是两个或多个不同的操作系统（如Windows和Linux）。另一种是以VMware工作站为代表的，虚拟机管理程序作为一个应用程序运行在宿主操作系统之上。

使用虚拟机的另一个领域是Java虚拟机（Java Virtual Machine，JVM）

- [拓展-虚拟化](https://www.vmware.com/cn/solutions/virtualization.html)
- [拓展-服务器虚拟化](https://www.youtube.com/watch?v=HxjzYPzc67s)
- [拓展-云计算1](https://www.youtube.com/watch?v=2QWz2FwBAxU)
- [拓展-云计算2](https://www.youtube.com/watch?v=3o_KKYfx8-o)

**4. 微内核结构：**

传统上把操作系统的所有程序都放在内核中，现在的操作系统有一种发展趋势，就是`把实现扩展机器功能的这部分代码向上移入更高层次，从而尽可能使操作系统保持最小的核心，称为微内核`。

微内核运行在核心态下，微内核实现所有操作系统都应具备的最基本的功能，包括中断处理、进程管理、处理机调度和进程间通信。

**5. 客户-服务器结构：**

客户-服务器结构`适用于分布式系统`。

客户通过消息传递与服务器通信，它不需要知道该消息是在本地机器上处理，还是通过网络发送到服务器，然后在服务器上处理。这样，`客户只要关心两件事：发送请求和接收应答`。

以上，操作系统有很多，设计者首先要清楚地知道它们要得到什么，也就是`设计目标是什么`。

### UNIX和Linux系统的核心结构

UNXI是当代最著名的`多用户、多进程、多任务分时操作系统`。

它的特点如下：可移植性好；有良好的用户界面；树形分级结构的文件系统；字符流式文件；丰富的核外系统进程；提供管道机制。

UNIX系统可分为三层：靠近硬件的底层是内核，即UNIX操作系统常驻内存部分；核心外的中间层是shell层；最高层是应用层。

内核是UNIX操作系统的主要部分，它实现进程管理、存储管理、文件系统和设备管理等功能，从而为核外的所有程序提供运行环境。

![核心结构图.jpg](../../_img/核心结构图.jpg)

UNIX 核心基本上采用层次结构。它可视为左、右两大部分。`左边是文件系统部分，右边是进程控制系统部分`。

文件系统部分涉及操作系统中各种信息的保存，通常都是以文件形式存放的，它相当于核心的`“静态”部分`。进程控制系统部分涉及操作系统中各种活动的调度和管理，通常以进程形式展现其生命活力，它相当于核心的`“动态”部分`。这两部分存在密切联系。

Linux操作系统采用`单体结构`，即所有的内核系统功能都包含在一个大型的内核软件之中。当然，Linux系统也支持可动态装载和卸载的模块结构。利用这些模块，可以方便地在内核中添加新的组件或卸载不需要使用的内核组件。Linux系统内核结构框图如下：

![Linux系统内核结构框图.jpg](../../_img/Linux系统内核结构框图.jpg)

`Linux主要应用于服务器系统和嵌入式系统。`
