# Linux 常见命令

## 1. Linux介绍

### 1.1 各个文件夹的作用

> [yanliang的博客](https://www.cnblogs.com/yoke/p/7217019.html)  
> [玉米疯收的博客](https://www.cnblogs.com/amboyna/archive/2008/02/16/1070474.html)

Linux号称一切皆文件，首先让我们来看看Linux文件，能有什么特殊的吧。

- `/bin`

普通用户的二进制可执行文件。/bin/usr/bin下，可以看到有ls，cp等可执行文件。

- `/boot`

存放引导加载器（bootstrap loader）使用的文件

- `/dev`（英文全称：device）

设备文件，Linux下一切皆文件，设备也是如此。

/input/mouse0来访问鼠标的输入，就像访问其他文件一样。这些文件都可以通过mkdir创建，为了将对这些`设备文件的访问`转化为`对设备的访问`，需要向响应的设备提供设备驱动模块。

- `/etc`（英文全称：editable text configuration）

/etc/passwd: 用户信息文件，给出了用户名、真实姓名、用户起始目录、加密口令和用户的其他信息。

/etc/group: 类似/passwd，但说明的不是用户信息而是组的信息。包括组的各种数据。

/etc/rc: 系统初始化文件，rc.d启动的配置文件和脚本

- `/home`

用户家目录的起点

- `/lib`

根文件系统上的程序所需要的共享库，避免每个程序都拥有相同子程序的副本，节省空间。

/usr/lib/modules: 包含系统核心可加载各个模块，如网络和文件系统驱动

- `/media`

挂载的媒体设备目录

- `/mnt（mount）`

让用户临时挂载其他的文件系统

- `/opt（optional）`

可选择的文件目录，一些软件包可以自定义安装在这里

- `/proc（process）`

虚拟的目录，是系统内存的映射。可直接访问这个目录来获取系统信息。

/proc/数字n: 关于进程n的信息目录，这里的n是这一进程的标识符

/proc/cpuinfo: 存放CPU的信息，如CPU的类型、制造商、型号和性能

/proc/devices: 当前运行的核心配置的驱动设备的列表

- `/root`

超级用户的目录

- `/run`

- `/sbin`（system binary）

系统管理命令。这个文件夹下是超级权限用户root的可执行命令存放地，普通用户无权执行这个目录下的命令（但是有时普通用户也需要用到，可以通过其他途径获取这个权限），我们要记住，凡是目录sbin中包含的都是root权限才能执行的。

/usr/sbin  例如有引导系统的init程序

- `/srv`（service）

- `/sys`

- `/tmp`（temporary）

临时文件目录

- `/usr`（unix share resource）

最庞大的目录，要用到的应用程序和文件几乎都在这个目录，这个目录中包含了命令库文件和通常操作中不会修改的文件。

/usr/bin: 集中了所有用户的命令，是系统的软件库

/usr/sbin: 包括根文件系统不必要的命令管理命令，例如多数服务程序

/usr/include: Linux下开发和编译应用程序的头文件

/usr/lib: 常用的动态链接库和软件包的配置文件

/usr/src: 源代码

/usr/local: 本地安装的程序都在 /usr/local下，这样子可以在系统升级新版本时无需重新安装程序。 /usr/local/bin：本地增加的命令；/usr/local/lib: 本地增加的库

/usr/share: 存放共享文件的目录

- `/var`

包含系统运行时要改变的数据。这些数据所在的目录的大小是要经常变化或扩充的。

### 1.2 常见的Linux发行版本

> [内核版本](https://www.kernel.org/)

- red hat: 软件经过专业的测试，很稳定
- fedora: 软件比较新，但是稳定性不好
- centos: 免费安全。其中版本号有规律，如7.6.1810代表centos7,经过6次设计，在18年10月发行
- debian: 界面良好
- ubuntu: 界面良好

Linux用命令行，目的是为了保证服务端的稳定性。图形化界面可能会导致不稳定。Linux主要的应用为：服务端的运维和开发。

## 2. Linux常用操作

### - ls

拓展选项是区分大小写的，但是顺序没有关系。

|       命令       |                       描述                        |
| :--------------: | :-----------------------------------------------: |
|      ls -l       |                详细文件的详细信息                 |
|      ls -lh      | 文件的大小以K、M的形式显示（h: --human-readable） |
| ls -a 或 ls -all |          显示所有的文件（包括隐藏文件）           |
|      ls -R       |   （recursive）递归显示，显示文件里面有什么目录   |
|      ls -tr      |                  以时间逆向排序                   |
|    ls /root /    |                  显示多个文件夹                   |

使用`ls -l`，各个字段的含义是什么呢？

比如drwxr-xr-x 7 zzl zzl 10240 Nov 23 21:01 Desktop

| 描述         | 含义                                           |
| :----------- | :--------------------------------------------- |
| d            | 文件类型                                       |
| rwxr-xr-x    | 当前用户、当前组、非当前用户或组对该文件的操作 |
| 7            | 该文件下下面的文件数量                         |
| zzl          | 该用户属于哪个文件                             |
| zzl          | 该用户属于哪个组                               |
| 10240        | 该文件的大小                                   |
| Nov 23 21:01 | 最后的修改时间                                 |
| Desktop      | 该文件名                                       |

文件类型表示：

| 文件类型 | 含义                 |
| :------: | :------------------- |
|    -     | 普通文件             |
|    d     | 目录文件             |
|    b     | 块特殊文件（设备）   |
|    c     | 字符特殊文件（终端） |
|    l     | 链接文件（快捷方式） |
|    f     | 命名管道             |
|    p     | 管道文件             |
|    s     | 套接字文件           |

-和d对应的权限：

| 权限  | 普通文件“-”含义 | 目录文件“d”含义              | 八进制表示 |
| :---: | :-------------: | :--------------------------- | :--------: |
|   r   |       读        | 显示目录内的文件名           |     4      |
|   w   |       写        | 修改目录内的文件名，删除文件 |     2      |
|   x   |      执行       | 进入目录                     |     1      |

文件颜色和底色：

| 颜色和底色 | 含义                                                               |
| :--------- | :----------------------------------------------------------------- |
| 蓝色       | 目录                                                               |
| 绿色       | 可执行文件                                                         |
| 红色       | 压缩文件                                                           |
| 浅蓝色     | 链接文件                                                           |
| 红色闪烁   | 表示链接有问题                                                     |
| 黄色       | 设备文件                                                           |
| 灰色       | 其他文件                                                           |
| 红色底纹   | SUID，用于二进制的可执行文件，执行命令时获得属主权限               |
| 黄色底纹   | SGID，用户目录，在该目录下创建的文件和目录，权限自动改为目录的属主 |
| SBIT       | 用于目录，该目录下新建的文件和目录，仅root和自己可以删除           |

文件权限：

chmod: 修改文件、目录权限。

| 命令格式   | 作用             |
| :--------- | :--------------- |
| chmod u ·· | 当前用户         |
| chmod g ·· | 用户组           |
| chmod o ·· | 其他用户和用户组 |
| chmod a ·· | 所有             |

```
文件a的当前用户权限增加x
chmod u+x 文件名a

文件a的当前用户权限减少x
chmod u-x 文件名a

文件a的当前用户权限为rwx
chmod u=rwx 文件名a

664为rw-r--r--
chmod 644 文件名a

chmod u+w g-w
```

chown: 更改属主、属组（权限冲突、以属主为主）

```
chown 用户名 文件，将login.html的属主改为zzl
chown zzl login.html

chown :数组名 文件，将文件的属组该为zzl
chown :zzl login.html （注意冒号）

将属主和属组同时改为zzl
chown zzl: login.html （注意冒号）
```

### - cd

更改当前的操作目录

```
回到上一次的目录
cd -
```

### - pwd

显示当前的目录名称

### - clear / Ctrl + L

清空屏幕

### - 摁Tab

目录补全

### - Ctrl + R

搜索以前输过的命令

### - echo 显示

### - > 输出重定向（并清空原先文件夹）

### 2.1 修改时区

```bash
cp  /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime
```

### 2.2 init的可选择操作

- `init 3`: 进入全命令行模式
- `init 5`: 图形化界面
- `init 0`: 关机

### 2.3 帮助命令

- `man`(manual)

```
篇章7，因为可能有重名的情况
man 7 man 

查看所有的命令
man -a 命令
```

- `help` 帮助

```
help cd

ls --help
```

shell（命令解释器）自带的命令称为内部命令，其他命令是外部命令

- `info` 帮助

info帮助比help更详细，是help的补充

- 如果还看不懂，则善用搜索引擎和文档

- 命令选项是：拓展命令的功能

## 3. 对文件夹的操作

### - mkdir

创建文件夹。拓展选项（显示创建过程、文件权限、多个目录）

| 命令                     | 含义                                                           |
| :----------------------- | :------------------------------------------------------------- |
| mkdir test               | 创建目录                                                       |
| mkdir -m a= rw test1     | (--mode)权限                                                   |
| mkdir -v test2           | 显示创建过程                                                   |
| mkdir -p testDir/test    | （--parent）创建多级目录，如果父目录存在，就在这个父目录下创建 |
| mkdir -p testDir/{a,b,c} | 在testDir文件夹下创建a,b,c文件夹                               |
| mkdir -p {a1,b1}/{c1,d1} | 在a1文件夹下创建c1,d1; 在b1文件夹下创建c1,d1                   |

### - touch

修改文件最后的修改时间（对时间的管理），如果文件不存在，就以当前的时间创建文件

(以字符串修改时间、以别的文件的时间修改当前文件的时间)

| 命令                          | 含义                                                                  |
| :---------------------------- | :-------------------------------------------------------------------- |
| touch test.md                 | 将test.md最后的修改时间改为现在，如果文件不存在，就以当前时间创建文件 |
| touch -ct 05061803 test.md    | (--no-create只能修改时间，--date以5月6号18：03分修改文件最后修改时间) |
| touch -r abc.md test.md       | (--reference)将abc.md的档案时间赋予给test.md                          |
| touch -d "2 days ago" test.md | 将test.md日期修改为2天以前                                            |

### - rmdir

删除空白文件夹

| 命令           | 含义                            |
| :------------- | :------------------------------ |
| rmdir -p a/b/c | （--parent）递归删除a,b,c文件夹 |
| rmdir -v test  | （--verbose）输出删除过程       |

### - rm

删除文件（谨慎使用，不要把根目录也删除了）

| 命令          | 含义                             |
| :------------ | :------------------------------- |
| rm test.md    | 删除文件                         |
| rm -vR test   | (--verbose, --recursive递归删除) |
| rm -f test.md | (--force)强制删除文件，且不提醒  |

### - cp

复制

| 命令                  | 含义                           |
| :-------------------- | :----------------------------- |
| cp  源地址 目的地址   | 复制文件                       |
| cp -r 源地址 目的地址 | (--recursive)复制文件夹        |
| cp -p                 | (--preserve)保留原有时间、属主 |
| cp -v                 | (--verbose)                    |

### - mv

重命名/移动

| 命令                     | 含义   |
| :----------------------- | :----- |
| mv 源地址 目的地址       | 移动   |
| mv 原先名字 修改后的名字 | 重命名 |

### - head

查看文件开头。

默认显示10行。

```
显示5行
head -5 文件名
```

### - tail

查看文件结尾。

| 命令           | 含义                                                   |
| :------------- | :----------------------------------------------------- |
| tail -f 文件名 | (follow)文件内容更新后，显示信息同步更新，用于日志文件 |
| tail -3 文件名 | 显示3行                                                |

### - more

分行显示

### - cat

(concatenate)文本内容（全部）显示到终端。

| 命令              | 含义                                                                                      |
| :---------------- | :---------------------------------------------------------------------------------------- |
| cat -ns test.md   | (--number：显示行编号，--squeeze-blank:如果有多个空行，合并成一个行)将test.md输出到控制台 |
| cat testA > testB | 将testA的内容覆盖到testB                                                                  |

### - wc

统计文件内容信息。

```
查看有多少行
wc -l
```

### - 通配符

- \*

字符匹配（多个字符）

- ?

字符匹配（单个字符）

## 4. VIM

vim文本编辑器。

在多种模式的切换，实现不需要鼠标。

vim的工作原理为：vim不是真正对用户的读和写，vim的写是先将文件写到一个隐藏文件中，如果你保存，就会将隐藏的内容覆盖到原来的文件。

### 4.1 正常模式 Normal node

| 操作     | 含义                 |
| :------- | :------------------- |
| H        | 上                   |
| J        | 下                   |
| K        | 左                   |
| L        | 右                   |
| ^        | 这一行的开头         |
| $        | 这一行的结尾         |
| yy       | 一整行进行复制       |
| 3yy      | 多行复制(会有提示)   |
| y$       | 复制到这一行的结尾   |
| p        | 粘贴（可以多次粘贴） |
| dd       | 剪切                 |
| 5dd      | 剪切5行              |
| d$       | 剪切到指定的行       |
| u        | 撤销（多次撤销）     |
| ctrl + R | 重做                 |
| x        | 单个字符的删除       |
| r        | 单个字符的替换       |

### 4.2 插入模式 Insert mode

| 命令      | 含义                       |
| :-------- | :------------------------- |
| i         | 在光标当前出现光标         |
| a         | 来到光标的后一位           |
| shift + i | 开头                       |
| A         | 光标移到结尾               |
| o（小写） | 光标来到下一行，并产生空行 |
| O（大写） | 光标来到上一行，并产生空行 |
| g         | 第一行                     |
| 11G       | 第11行                     |
| G         | 最后一行                   |

### 4.3 命令模式 command mode

文件保存退出、查找替换

| 命令            | 含义          |
| :-------------- | :------------ |
| :w /root/a.txt  | 保存          |
| :q              | 保存退出      |
| :q!             | 不保存退出    |
| :! pwd          | 执行Linux命令 |
| /x              | 在文章中查找x |
| :s/old/new      | 单行替换      |
| :%s/old/new//g  | 全篇文章替换  |
| :3,5s/old/new/g | 指定行替换    |
| vim /etc/vimrc  | 修改配置文件  |
| :set nu         | 显示num       |
| :set nu         | 显示行号      |
| :set nonu       | 不显示行号    |

### 4.4 可视模式 visual mode

对文件进行大量的重复操作

| 命令     | 含义                             |
| :------- | :------------------------------- |
| v        | 字符可视模式                     |
| shift v  | 行可视模式                       |
| Ctrl + V | 块可视模式（在多行前插入，删除） |

<!-- 
对用户、用户组
  配置文件
    /etc/passwd
      使用者账号资讯
      7个字段
        用户的名称:root
        x：需要密码验证；如果删除代表不需要密码验证
        uid：linux是以uid判断是哪一个用户；uid=0代表root；
        gid
        注释
        用户的家目录（usermod -d）
        命令解释器
      也可以在配置文件下新建一行，代表多了一个用户
    /etc/shadow
      使用者账号资讯加密
      用户加密的密码（即使相同的密码，加密后的密码也是不一样的）
    /etc/group 
      群组资讯
      需不需要密码验证
      gid
      用户名；该用户还属于其他组（属于多个组）
    /etc/default/useradd
      定义资讯
    /etc/login.defs
      系统广义设定
    /etc/skel
      内含定义档的目录
  useradd  新建用户
    useradd -d /home/guestHome guest useradd -d 目录 用户名
    useradd -g group1 user2 新建user2,并将user2加入群组group1
    useradd -r zzz 新建系统用户zzz
    useradd -e 04/05/13 用户名 (expire_date)账号终止时间
  passwd  修改用户密码
    在工作中最好使用一个复杂的密码
  usermod  修改用户属性
    -d 用户家目录的位置
    usermod -g group1 user1 更改用户所属的用户组
    usermod -l newname oldname （login_name）更改用户名字
  userdel  删除用户
    userdel -r 用户 用户的所有文件夹都删除掉
    userdel 用户 删除用户，但是家目录不会被删除
  chage  修改生命周期，限制用户什么时候可以登陆
  id  查找是否存在
  groupadd  新建用户组
  groupdel  删除用户组
  su - user1 切换用户 
    没有减号，不完全切换，位置还是root，但是仍然不能访问
  普通用户只可以访问自己的家目录+root开放给用户的文件
  用户会被记录到/etc/passwd文件下
    tail -10 /etc/passwd
  /etc/shadow  用户密码相关的文件
  用户组：多个用户相同的操作
其他命令
  sudo  能使用户运行自己一开始不能运行的命令
    visudo  设置需要使用sudo的用户（组）
    ： !which shutdown 查询命令所在的文件目录
    tmpuser1 localhhost=/sbin/shutdown -c 在visudo中写该语句
      除了localhost还有ALL， ALL=(run as All user，run as All groups”) 
    sudo /sbin/shutdown -c tmpuser1可以使用上面的命令
  su 切换用户
    su - 用户名
  shutdown -h 30 -->